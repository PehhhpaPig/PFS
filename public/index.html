<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NuTracker</title>
  <link rel="stylesheet" href="css/style.css">
  <script type="module" defer src="js/app.js"></script>
</head>
<body>
  <div class="container">
  <h1 id="header">Please Log In to NuTracker</h1>

  <!-- Auth -->
  <section id="auth">
    <div id="passwordRow">
      <input id="user" placeholder="Username" autocomplete="off" required>
      <input id="pass" type="password" placeholder="Password" autocomplete="off" required>
    </div>
    <div id="codeRow" hidden>
      <input id="code" placeholder="6â€‘digit code" autocomplete="off">
    </div>
    <button id="loginBtn">Login</button>
    <p><a href="reset.html">Forgot password?</a></p>
    <a href="register.html">Register</a>
    <div id="fuck"></div>
    <div id="test"></div>
    <form id="captcha" hidden style="margin-top:2rem">
      <div id="MyAncestorsAreSmilingOnMeImperial"></div>
        <!--<img id="captchaImg" src="/PFS/securimage/securimage_show.php" alt="CAPTCHA Image" /><br><br>
        <input type="text" name="captcha_code" size="10" maxlength="6" placeholder="Enter CAPTCHA" required autocomplete="off">
        <a href="#" onclick="document.getElementById('captchaImg').src = '/PFS/securimage/securimage_show.php?' + Date.now(); return false;">[ Different Image ]</a>
    --><br><br>
        <input type="submit" value="Submit">
        <p id="captchaHint" style="color: red; font-weight: bold;"></p>
        
    </form>
    
  </section>

  <!-- Main app UI -->
  <section id="app" hidden>
    <!-- Scan panel -->
    <h2>Scan Tag</h2>
    <input id="tagInput" placeholder="Tag ID (hex)" autocomplete="off"><button id="scanBtn">Submit</button>
    <br><br><br>
    <h2>Add Item</h2>
    <input id="itemName" placeholder="Name" autocomplete="off" required>
    <input id="itemStock" type="number" min="0" placeholder="Stock" autocomplete="off" required numeric>
    <input id="itemLoc"   placeholder="Location" autocomplete="off" required>
    <input id="itemTag"   placeholder="RFID (hex optional)" autocomplete="off">
    <br>
    <button id="addItemBtn">Add</button>
    <br><br><br>
    <h2>Items</h2>
    <table>
     <thead><tr><th>ID</th><th>Name</th><th>Stock</th><th>Location</th><th>RFID Tag</th><th></th></tr></thead>
     <tbody id="itemsBody"></tbody>
    </table>
    <br><br><br>
    <!-- Scan history -->
    <h2>Recent Scans</h2>
    <table>
      <thead><tr><th>ID</th><th>Tag</th><th>User</th><th>Time</th></tr></thead>
      <tbody id="scansBody"></tbody>
    </table>

    <button class="logout" onclick="location.reload()">Logout</button>
  </section>
  </div>

  <script>
    async function securimageRefreshCaptcha(offeringToTheBloodGod, anotherOffering){
  const sendHelpYesterday = await fetch('/PFS/api/auth/generate_captcha.php', {
      method : 'POST',
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body   : JSON.stringify({
        this_took_me_too_long_to_figure_out_AI_is_useless_i_am_a_golden_god : ""
      })
    });
  
    const response = await sendHelpYesterday.json();
    try{
       document.getElementById("MyAncestorsAreSmilingOnMeImperial").innerHTML=response.godisdeadandthiscodekilledhim;
    }
    catch (err){
        alert("Well, it was working, ho hum... "+err);
    }
}
  </script>
</body>
</html>